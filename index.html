
<!DOCTYPE html>
<html>
<head>
    <title>Santu AI: Real AR Book</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <style>
        .menu { position: absolute; bottom: 20px; width: 100%; text-align: center; z-index: 10; }
        button { padding: 12px 20px; margin: 5px; border-radius: 8px; border: none; background: #FFD700; font-weight: bold; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        #file-input { position: absolute; top: 20px; left: 20px; z-index: 10; background: white; padding: 10px; border-radius: 8px; }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">

    <div id="file-input">
        <label><b>Open Your PDF Book:</b></label><br>
        <input type="file" id="pdfFile" accept="application/pdf">
    </div>

    <div class="menu">
        <button onclick="changePage(-2)">⬅️ PREVIOUS</button>
        <button onclick="changePage(2)">NEXT ➡️</button>
        <button style="background: #00BFFF;" onclick="alert('Santu AI: Analyzing this page for your Economics exam...')">SANTU AI HELP</button>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-marker preset="hiro">
            <a-plane id="leftPage" position="-0.52 0 0" rotation="-90 0 0" width="1" height="1.4" material="side: double; color: #ffffff"></a-plane>
            <a-plane id="rightPage" position="0.52 0 0" rotation="-90 0 0" width="1" height="1.4" material="side: double; color: #ffffff"></a-plane>
            <a-box position="0 0 0" rotation="-90 0 0" width="0.04" height="1.4" depth="0.1" material="color: #333"></a-box>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        const pdfjsLib = window['pdfjs-dist/build/pdf'];
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        let pdfDoc = null;
        let pageNum = 1;

        document.getElementById('pdfFile').onchange = function(e) {
            let file = e.target.files[0];
            let reader = new FileReader();
            reader.onload = function() {
                let typedarray = new Uint8Array(this.result);
                pdfjsLib.getDocument(typedarray).promise.then(pdf => {
                    pdfDoc = pdf;
                    renderBook();
                });
            };
            reader.readAsArrayBuffer(file);
        };

        function renderPage(num, elementId) {
            if (num > pdfDoc.numPages || num < 1) {
                document.getElementById(elementId).setAttribute('visible', 'false');
                return;
            }
            document.getElementById(elementId).setAttribute('visible', 'true');
            
            pdfDoc.getPage(num).then(page => {
                let viewport = page.getViewport({scale: 2.0}); // High resolution for clear text
                let canvas = document.createElement('canvas');
                let ctx = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;

                page.render({canvasContext: ctx, viewport: viewport}).promise.then(() => {
                    let texture = new THREE.CanvasTexture(canvas);
                    let mesh = document.getElementById(elementId).getObject3D('mesh');
                    mesh.material.map = texture;
                    mesh.material.needsUpdate = true;
                });
            });
        }

        function renderBook() {
            renderPage(pageNum, 'leftPage');
            renderPage(pageNum + 1, 'rightPage');
        }

        function changePage(offset) {
            if (!pdfDoc) return;
            if (pageNum + offset >= 1 && pageNum + offset <= pdfDoc.numPages) {
                pageNum += offset;
                renderBook();
            }
        }
    </script>
</body>
</html>
